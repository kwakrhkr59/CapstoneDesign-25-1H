<!-- Template for PROJECT REPORT of CapstoneDesign 2025-2H, initially written by khyoo -->
<!-- 본 파일은 2025년도 컴공 졸업프로젝트의 <1차보고서> 작성을 위한 기본 양식입니다. -->
<!-- 아래에 "*"..."*" 표시는 italic체로 출력하기 위해서 사용한 것입니다. -->
<!-- "내용"에 해당하는 부분을 지우고, 여러분 과제의 내용을 작성해 주세요. -->

# Team-Info
| (1) 과제명 | 위성인터넷 해킹을 통한 프라이버시 유출 방지를 위한 Fingerprinting 기법을 활용한 Starlink 네트워크 취약점 분석
|:---  |---  |
| (2) 팀 번호 / 팀 이름 | 16-RexT |
| (3) 팀 구성원 | 곽현정(2171003): 팀장, Llama/Triplet기반 모델 학습, 기말 발표 <br> 강호성(2171002): 팀원, LaserBeak 기반 모델 학습, 하이퍼 파라미터 튜닝, 중간 발표 <br> 홍지우(2171053): 팀원, DF 기반 모델 학습, 데이터 전처리/분석, 계획 발표	 |
| (4) 팀 지도교수 | 오세은 교수님 |
| (5) 과제 분류 | 연구 과제 |
| (6) 과제 키워드 | Starlink Network, AI for security, Cyber Security, Website Fingerprinting  |
| (7) 과제 내용 요약 | **연구 목적**<br> 본 과제는 Starlink와 같은 저궤도(LEO) 기반 위성 인터넷 환경에서도 Website Fingerprinting(WF) 공격이 가능한지를 실증적으로 분석하고, 해당 환경에 특화된 공격 기법을 제안하는 것을 핵심 목표로 하는 연구이다.<br><br> **Website Fingerprinting(WF) 공격의 개요**<br> NAT(Network Address Translation)와 패킷 암호화로 인해 개별 패킷 내용을 복호화하여 분석하는 것은 사실상 불가능에 가깝지만, 패킷의 크기, 전송 간격, 방향 등 메타데이터를 활용하면 암호화된 트래픽에서도 사용자의 웹사이트 방문 패턴을 추론할 수 있다. 이러한 방식의 공격을 Website Fingerprinting(WF)이라 한다.<br><br> **기존 기법의 한계와 Starlink의 특수성**<br> 기존 WF 공격 기법으로는 CNN 기반의 DF(Deep Fingerprinting), VarCNN 등이 활용되어 왔으나, 위성 인터넷은 전통적인 유선망(Fiber network)과 달리 고지연, 위성 간 핸드오프(hand-off), RTT 변동성 등 특수한 네트워크 특성을 가지므로 기존 기법을 그대로 적용할 경우 성능 저하가 발생한다. 실제로 기존 유선 인터넷망에서는 WF 모델이 95% 이상의 정확도를 보이는 반면, Starlink 환경에서는 정확도가 40%대로 급감하는 것을 baseline 실험을 통해 확인하였다.<br><br> **연구 방법 및 모델 설계**<br> 본 연구는 특히 Starlink 환경에서의 네트워크 특성이 WF 공격 성능에 미치는 영향을 분석하고, 이를 바탕으로 위성 통신 환경에 최적화된 Transformer 기반의 새로운 공격 기법을 설계하는 데 초점을 맞추고 있다. 이를 위해 실제 Starlink 환경에서 75개 웹사이트를 대상으로 수집한 데이터셋을 기반으로 CNN 기반 DF, VarCNN 등의 기존 기법을 baseline으로 설정하여 학습하였으며, 최신(SOTA) 성능 확보를 위해 Transformer 및 강화학습 기반 모델도 학습 중에 있다.<br><br> **초기 실험 결과 및 앞으로의 연구 계획**<br> 초기 실험 결과, Starlink 환경에서도 약 56%의 공격 정확도를 달성할 수 있음을 확인하였고, 위성 인터넷의 특성을 반영한 feature engineering을 통해 모델 성능을 추가적으로 향상시키고자 하고 있다. 이 과정에서 도출된 위성망 고유의 취약점을 토대로, Transformer 기반의 모델을 학습하여 Firefox on Starlink 환경에서의 WF 최신(SOTA) 모델을 제안하는 것을 궁극적인 목표로 한다.<br><br> **연구 의의 및 추가 연구 방향**<br> 본 연구는 기존 WF 연구들이 다루지 않았던 위성 인터넷 환경의 보안 취약성을 최초로 체계적으로 분석하고, 해당 환경에 특화된 공격 기법을 제안했다는 점에서 의의가 있다.<br> 졸업 프로젝트 이후에는 본 연구를 확장하여 LEO 기반 위성 통신 환경에 적합한 보안 프레임워크를 제시하고, 위성 네트워크 보안 정책 수립과 대응 전략 마련에 기여하는 것을 목표로 한다.<br> |

<br>

# Project-Summary
| 항목 | 내용 |
|:---  |---  |
| (1) 문제 정의 | 기존 인터넷은 주로 지상 광케이블을 통해 제공되고 있으나, 이 방식은 지형적·경제적 한계로 인해 전 세계 모든 지역에 동일한 품질의 인터넷을 제공하기 어렵다. 이에 대한 대안으로 등장한 것이 저궤도(LEO) 위성 기반의 인터넷이며, 대표적인 서비스로 Starlink가 있다. Starlink는 지구 저궤도에 수천 개의 위성을 배치하여 인터넷을 제공하는 서비스로, _빠른 다운로드 속도와 지상, 해상, 상공 등 넓은 커버리지를 자랑하며,_ 이미 전 세계 많은 국가에서 사용 중이며 한국에도 조만간 상용화될 예정이다.<br><br>그러나 Starlink 네트워크는 긴 지연 시간(latency), 빈번한 위성 간 핸드오프(hand-off), 높은 패킷 손실률(packet loss) 등 지상 기반 네트워크와는 근본적으로 다른 트래픽 특성을 가진다. 본 연구는 이러한 특성을 이용한 웹사이트 핑거프린팅(Website Fingerprinting, WF) 공격 가능성을 분석하고, 이로 인해 발생할 수 있는 사용자 프라이버시 침해의 보안 위협을 탐구한다.<br><br>_본 연구에서는 위성 인터넷 환경에서도 WF공격이 실질적으로 가능함을 실험적으로 분석하였다. 이를 통해 위성 인터넷 환경의 보안 연구에 기여하고, Starlink를 비롯한 위성 인터넷 서비스의 보안 정책 강화 필요성을 제시한다._ |
| (2) 기존연구와의 비교 | 웹사이트 핑거프린팅 공격은 암호화된 트래픽의 메타데이터(패킷 방향, 크기, 타임스탬프 등)를 기반으로 사용자가 방문한 웹사이트를 식별하는 공격 방식이다. 대표적인 초기 연구인 Deep Fingerprinting(DF)[[1]](#ref1)은 CNN 기반의 심층학습으로 높은 정확도를 달성했으며, 이후 Tik-Tok 및 Var-CNN[[3]](#ref3)은 트래픽 특징(방향성, 시간정보)을 별도의 CNN 모델로 학습하여 성능을 높였다. 최근 발표된 Laserbeak[[4]](#ref4) 모델은 다중 채널 입력 방식을 통해 기존 모델 대비 성능을 크게 향상시켰다.<br><br>그러나 기존 연구들은 안정적인 지상 네트워크의 트래픽 패턴에 기반하고 있으며, Starlink와 같은 위성 네트워크 환경의 특수성을 고려하지 못했다. 본 연구는 Starlink의 고유한 트래픽 특성을 분석하여 기존 연구와의 차별성을 강조하고, Starlink 환경에 최적화된 핑거프린팅 모델 개발 필요성을 제시한다.<br><br>**[참고 논문]**<br><span id="ref1">[1] [A. Sirinam et al., “Deep Fingerprinting: Undermining Website Fingerprinting Defenses with Deep Learning,” ACM CCS, 2018.](https://dl.acm.org/doi/10.1145/3243734.3243768) </span><br><span id="ref2">[2] [A. Panchenko et al., “Website Fingerprinting at Internet Scale,” NDSS, 2021.](https://www.ndss-symposium.org/wp-content/uploads/2017/09/10_3-ndss2016-slides.pdf)</span><br><span id="ref3">[3] [ S. Bhat, D. Lu, A. Kwon, and S. Devadas, "Var-CNN: A data-efficient website fingerprinting attack based on deep learning," Proc. Privacy Enhancing Technol., vol. 2019, no. 4, pp. 292-310, Jul. 2019.](https://arxiv.org/abs/1802.10215) </span><br><span id="ref4">[4] [N. Mathews et al., “LASERBEAK: Multi-Channel Representations and Transformer-Based Models for High-Accuracy Website Fingerprinting,” 2024 IEEE Symposium on Security and Privacy (S&P), 2024.](https://dl.acm.org/doi/10.1109/TIFS.2024.3468171) </span> |
| (3) 제안 내용 | - Starlink 환경에서 실제 발생하는 트래픽 데이터를 실시간 수집하고 분석하여 기존 모델(DF, Var-CNN)의 공격 성능을 평가한다.<br>- Starlink 네트워크의 고유한 특성(긴 latency, 잦은 핸드오프, 높은 패킷 손실)을 바탕으로 특화된 feature engineering을 실시하고, 트랜스포머 기반의 StarPrint 모델을 개발하여 기존 핑거프린팅 모델 대비 성능을 향상한다.<br>- (추후 연구 과제) Starlink 환경에서 효과적인 방어 전략(Padding, Obfuscation, Adversarial Training)을 설계하여 실험적으로 검증한다. |
| (4) 기대효과 및 의의 | 본 연구는 Starlink와 같은 위성 인터넷 환경에서의 WF 공격 가능성을 세계 최초로 분석하고, 기존 지상 네트워크와의 근본적 차이점 및 보안 취약성을 규명한다. 이를 통해 Starlink 사에 보안 위험성을 명확히 제시하고, Starlink 및 유사 위성 인터넷 서비스를 위한 보안 전략 수립에 기초 자료로 활용될 수 있을 것으로 기대된다. 결과적으로 본 연구는 다가올 6G 시대에 위성 인터넷 보안 인프라 구축의 초석이 될 것으로 예상된다. |
| (5) 주요 기능 리스트 | 1. Starlink 특화된 트래픽 feature 추출 및 분석(timestamp, 패킷 크기, Inter-Packet Delay, burst)<br>2. 기존 CNN 기반 모델(DF, Var-CNN 등)의 WF 공격 성능 평가<br>3. Starlink 환경에 최적화된 트래픽 feature engineering 및 트랜스포머 기반 StarPrint 모델 개발<br>4. TSNE, HDBScan 등의 데이터 시각화 도구를 활용한 트래픽 특징 분석<br>5. Data augmentation을 통한 모델 성능 향상 및 과적합(overfitting) 문제 해결 |


<br>
 
# Project-Design & Implementation
| 항목 | 내용 |
|:---|:---|
| **(1) 요구사항 정의** | **1) 문제 상황 정의**<br>Starlink를 통해 사용자가 웹사이트에 접속할 때 발생하는 네트워크 트래픽을 분석하여, 사용자가 접속하려는 웹사이트가 무엇인지 공격자가 알 수 있다. 본 프로젝트에서는 이러한 공격이 실제로 가능함을 입증하여, Starlink 네트워크의 취약점을 알리고자 한다.<br><br>![문제 상황 정의](https://github.com/Capstone-RexT/Documents/blob/main/images/%EB%AC%B8%EC%A0%9C%20%EC%83%81%ED%99%A9%20%EC%A0%95%EC%9D%98.png?raw=true)<br><br>**2) 기능별 상세 요구사항**<br>1. **트래픽 전처리 및 특징 추출**<br>&nbsp;&nbsp;- 캡처한 트래픽에서 웹사이트 식별에 유의미한 특징(패킷 크기 분포, 시간 간격 등) 추출<br>&nbsp;&nbsp;- 불필요한 패킷 제거 및 데이터 정리<br>&nbsp;&nbsp;- 트래픽을 세션 단위로 분류 및 저장<br>2. **웹사이트 식별 분석**<br>&nbsp;&nbsp;- 트래픽 특징 기반 웹사이트 식별<br>&nbsp;&nbsp;- ML/통계 기법으로 트래픽 패턴 비교<br>&nbsp;&nbsp;- Precision, Recall, Accuracy 등 성능 지표 제공<br>3. **보안 취약점 입증**<br>&nbsp;&nbsp;- 공격자의 관점에서 웹사이트 판별 가능<br>&nbsp;&nbsp;- Starlink 네트워크의 보안 취약점 분석 및 보고 |
| **(2) 전체 시스템 구성** | **1) 전체 시스템 아키텍처**<br>본 연구는 Starlink 네트워크에서 발생하는 트래픽을 분석하여, 사용자가 방문한 웹사이트를 식별하는 것을 목표로 한다. 전체 프레임워크는 트래픽 전처리 및 특징 추출 단계와 트래픽 분석 및 웹사이트 식별 단계의 두 가지 주요 모듈로 구성되며, 각 단계는 순차적으로 데이터를 처리하여 최종 분류 결과를 도출한다.<br><br>![시스템 구성도](https://github.com/Capstone-RexT/Documents/blob/main/images/%EC%A0%84%EC%B2%B4%20%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98.png?raw=true)<br><br>**2) 주요 모듈 및 역할**<br>- 트래픽 전처리 및 특징 추출 모듈: Starlink 네트워크에서 수집한 트래픽 데이터를 정제하고, 웹사이트 식별에 유의미한 특징(feature)을 추출하는 역할을 수행한다. _패킷의 방향, 크기, 타임스탬프 정보를 포함한 입력값(메타데이터)로부터 각각의 수치값을 적절한 로직을 거쳐 패킷 간 지연시간(IPD) 등의 고차원 특징 벡터로 변환한다._ <br>- 웹사이트 식별 분석 모듈 전처리된 특징 데이터를 입력으로 받아, 머신러닝 또는 딥러닝 기반의 분류 모델을 통해 사용자가 방문한 웹사이트를 식별한다. 본 연구에서는 DFNet 구조를 기반으로 Convolutional Vision Transformer(CvT)를 결합한 모델을 사용하여, Starlink 특성에 최적화된 고성능 웹사이트 분류를 달성하였다.<br><br> **3) 주요 오픈소스**<br>- **model_selection**: 모델 학습 시 사용    [scikit-learn/sklearn/model_selection](https://github.com/scikit-learn/scikit-learn/tree/main/sklearn/model_selection)  <br>- **TSNE**: 데이터 분석 및 시각화    [tSNE](https://github.com/shivanichander/tSNE)  <br>- **hdbscan**: 데이터 분석 및 시각화    [HDBSCAN](https://scikit-learn.org/1.5/modules/generated/sklearn.cluster.HDBSCAN.html)  <br>- **keras**: 모델 아키텍처 설계 및 학습 (models, layers)    [Keras](https://www.tensorflow.org/guide/keras?hl=ko)  <br>- **tensorflow**: transformer 모델 학습    [tensorflow](https://github.com/tensorflow/tensorflow)  <br>- **sklearn**: 모델 아키텍처 설계 및 학습    [scikit-learn](https://scikit-learn.org/stable/)  <br>- **pickle**: 데이터셋 전처리 및 수정    [pickle](https://github.com/enthought/Python-2.7.3/blob/master/Lib/pickle.py)  <br>- **numpy**: 데이터 핸들링    [numpy](https://github.com/numpy/numpy)  <br>- **pandas**: 데이터 핸들링    [pandas](https://github.com/pandas-dev/pandas)  |
| **(3) 주요엔진 및 기능 설계** | **1) 데이터 전처리 및 특징 탐색, 시각화**<br>본 연구에서는 암호화된 네트워크 트래픽 데이터를 .pcap 형식으로 제공받아, 이를 분석 가능한 .txt 형식으로 파싱하여 활용하였다. .txt 파일의 왼쪽 열은 패킷 발생 시각(timestamp), 오른쪽 열은 패킷의 크기(size)를 나타낸다.<br><br><div style="display: flex; gap: 10px;">  <img src="https://github.com/Capstone-RexT/Documents/blob/main/images/wireshark.png?raw=true" width="45%" />  <img src="https://github.com/Capstone-RexT/Documents/blob/main/images/%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B%20%EC%83%98%ED%94%8C.png?raw=true" width="45%" /></div><br><br>위에서 설명한 .txt 형태의 데이터를 활용하여, 시간에 따른 패킷 크기 변화(timestamp-size)와 시간에 따른 패킷 수 변화(timestamp-packet count)를 그래프로 시각화한 결과는 다음과 같다.<br><div style="display: flex; gap: 10px;">  <img src="https://github.com/Capstone-RexT/Documents/blob/main/images/timestamp-size%20%EA%B7%B8%EB%9E%98%ED%94%84.png?raw=true" width="45%" />  <img src="https://github.com/Capstone-RexT/Documents/blob/main/images/timestamp-packet%20count%20%EA%B7%B8%EB%9E%98%ED%94%84.png?raw=true" width="45%" /></div><br><br>**2) 트래픽 전처리 및 특징 추출 모듈**<br>- 구현 방식: Python의 Scapy, Pandas 등의 라이브러리를 활용하여 데이터 필터링 및 특징 추출을 수행<br>- 입력 데이터: .pcap 파일에서 추출한 패킷 정보<br>- 출력 데이터: 분석 가능한 형태로 가공된 데이터셋 (.txt, .npz, .npy 등)<br>- 주요 특징: 패킷의 방향성, 크기 분포, 패킷 간 시간 간격 등 트래픽 전송 패턴을 효과적으로 나타내는 feature를 중심으로 구성<br><br>**3) Transformer 기반 웹사이트 식별(WF)**<br>![모델 아키텍처](https://github.com/Capstone-RexT/Documents/blob/main/images/%EB%AA%A8%EB%8D%B8%20%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98.png?raw=true)- 구현 방식: Convolutional Vision Transformer(CvT)를 기반으로 기존의 Deep Fingerprinting(DF) 모델을 분류기로 적용<br>- 입력 데이터: 데이터 전처리 및 특징 추출 모듈에서 생성된 IPD(Inter-Packet Delay, 패킷 간 시간 간격) feature 데이터<br>- 출력 데이터: 테스트 데이터에 대해 수행된 웹사이트 식별 결과 및 분류 정확도 |
| **(4) 주요 기능의 구현** | **1) 트래픽 전처리 및 특징 추출 기능**<br> - Starlink 네트워크 트래픽의 특성을 보다 효과적으로 반영할 수 있는 feature를 탐색하였다.<br>- Python의 Scapy와 Pandas 라이브러리를 활용하여 데이터를 필터링하고, 패킷의 방향(Direction), 크기(Size), 패킷 간 시간 간격(Inter-Packet Delay, IPD) 등 트래픽 전송 패턴을 잘 나타낼 수 있는 다양한 feature들을 추출하였다.<br>- 추출된 feature는 TSNE와 HDBSCAN을 활용해 분석하였으며, 시각화 결과 intraclass variation이 가장 낮은 IPD(패킷 간 시간 간격)를 최종 feature로 선정하였다.<br><br> **2) 웹사이트 식별 분석 기능**<br>- 본 연구에서는 Convolutional Vision Transformer(CvT) 기반의 모델과 DF Net(Deep Fingerprinting의 CNN 블록) 아키텍처를 결합한 모델을 개발하였다. 해당 모델은 입력된 Starlink 네트워크 트래픽 데이터를 1D 컨볼루션 기반 임베딩 레이어를 통해 고차원 특징으로 변환한 뒤, 컨볼루션 블록과 트랜스포머 블록을 교차 배치하여 계층적으로 심층 특징을 추출한다. 트랜스포머 블록은 Multi-head Self-Attention(MHSA)을 통해 전역적(global) 의존성을 포착함으로써 복합적이고 정교한 트래픽 패턴을 효과적으로 학습할 수 있도록 구성하였다. 특히 CvT에서 제안된 컨볼루션 프로젝션 기반 MHSA를 도입하여 모델의 효율성을 더욱 향상시켰다.<br>- 최종적으로 추출된 특징은 Fully-Connected 레이어를 통해 웹사이트 핑거프린팅 공격에 대한 분류 결과로 이어지며, 본 모델은 기존 DF 모델과 결합함으로써 해당 작업에 최적화된 하이퍼파라미터를 효과적으로 활용할 수 있었다. 그 결과, 기존 SOTA 모델 대비 약 7% 향상된 성능을 달성하였다.|
| **(5) 기타** | **1) 스타트 단계에서의 검증 내용** : <br>1. Starlink 트래픽 및 feature 분석 완료 <br>2. Starlink 네트워크 트래픽에 특화된 모델 검증 완료 <br>3. 2번에서 검증한 모델 중 baseline model을 확정하고, 기존 딥러닝 기반의 fingerprinting 모델에 Laserbeek와 Transformer를 결합한 새로운 모델 개발 중: 기존 모델 대비 약 8%의 성능 향상 확인 <br><br>**2) 전체 진척도 (전체 목표의 약 50% 달성)**<br>1. 스타트 단계 설계/개발/검증 (1-2주차) → 완료 <br>2. 모델 비교 검증 및 학습 (3-4주차) → 완료 <br>_3. 정확도/차별율 분석 (4주차) → 완료_ <br>_4. 국내 학회 CISC-S’25 제출 완료_ <br> - 해외 학회 : INFOCOM(7월) 투고 예정 <br>- 매주 화요일 지도교수님, 멘토님과 미팅을 통해 피드백 반영 및 진척도 조율 중 |
